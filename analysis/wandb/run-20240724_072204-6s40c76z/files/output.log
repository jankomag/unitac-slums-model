Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
  | Name              | Type       | Params | Mode
---------------------------------------------------------
0 | buildings_encoder | ModuleList | 1.6 K  | train
1 | encoder           | DeepLabV3  | 39.6 M | train
2 | fusion_layers     | ModuleList | 1.4 M  | train
3 | xtra_fusion       | Conv2d     | 514    | train
4 | decoder_fusion    | Conv2d     | 4      | train
---------------------------------------------------------
41.0 M    Trainable params
0         Non-trainable params
41.0 M    Total params
164.179   Total estimated model params size (MB)
Trainer was signaled to stop but the required `min_epochs=65` or `min_steps=None` has not been met. Training will continue...
[{"name": "A", "type": "module", "fullType": "module"}, {"name": "Affine", "type": "type", "fullType": "type"}, {"name": "Any", "type": "_AnyMeta", "fullType": "typing._AnyMeta"}, {"name": "Box", "type": "type", "fullType": "type"}, {"name": "CRSTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Callback", "type": "type", "fullType": "type"}, {"name": "ClassConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "ClassInferenceTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Client", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "ConcatDataset", "type": "type", "fullType": "type"}, {"name": "CustomGeoJSONVectorSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "CustomRasterizedSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "CustomSlidingWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "CustomVectorOutputConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "DataLoader", "type": "type", "fullType": "type"}, {"name": "DeepLabHead", "type": "type", "fullType": "type"}, {"name": "Dict", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "EarlyStopping", "type": "type", "fullType": "type"}, {"name": "F", "type": "module", "fullType": "module"}, {"name": "FeatureMapVisualization", "type": "type", "fullType": "type"}, {"name": "FixedStatsTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "GeoJSONVectorSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "GeoJSONVectorSourceConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "IdentityCRSTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Iterator", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "LabelSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "LightningDataModule", "type": "type", "fullType": "type"}, {"name": "List", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "MergeDataset", "type": "type", "fullType": "type"}, {"name": "ModelCheckpoint", "type": "type", "fullType": "type"}, {"name": "MultiInputCrossValidator", "type": "type", "fullType": "type"}, {"name": "MultiModalDataModule", "type": "type", "fullType": "type"}, {"name": "MultiPolygon", "type": "type", "fullType": "type"}, {"name": "MultiResPredictionsIterator", "type": "type", "fullType": "type"}, {"name": "MultiResolutionDeepLabV3", "type": "type", "fullType": "type"}, {"name": "NonNegInt", "type": "ConstrainedNumberMeta", "fullType": "pydantic.types.ConstrainedNumberMeta"}, {"name": "Optional", "type": "_SpecialForm", "fullType": "typing._SpecialForm"}, {"name": "OrderedDict", "type": "type", "fullType": "type"}, {"name": "Polygon", "type": "type", "fullType": "type"}, {"name": "PolygonWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "PosInt", "type": "ConstrainedNumberMeta", "fullType": "pydantic.types.ConstrainedNumberMeta"}, {"name": "PredictionVisualizationCallback", "type": "type", "fullType": "type"}, {"name": "RasterSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterStats", "type": "type", "fullType": "type"}, {"name": "RasterTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterioCRSTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterioSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterizedSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterizedSourceConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "Scene", "type": "type", "fullType": "type"}, {"name": "SemanticSegmentationDiscreteLabels", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationEvaluator", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationLabelStore", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationLabels", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationSlidingWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "Sequence", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "SlidingWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "StatsTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Subset", "type": "type", "fullType": "type"}, {"name": "TF_TYPE_TO_TF_FUNC", "type": "dict", "fullType": "dict"}, {"name": "TYPE_CHECKING", "type": "bool", "fullType": "bool"}, {"name": "Trainer", "type": "type", "fullType": "type"}, {"name": "TransformType", "type": "EnumType", "fullType": "enum.EnumType"}, {"name": "Transformer", "type": "type", "fullType": "type"}, {"name": "Tuple", "type": "_TupleType", "fullType": "typing._TupleType"}, {"name": "Union", "type": "_SpecialForm", "fullType": "typing._SpecialForm"}, {"name": "VectorSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "VectorSourceConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "WandbLogger", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "XarraySource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "affine_transform_buildings", "type": "Affine", "fullType": "affine.Affine"}, {"name": "aggregated_predictions", "type": "list", "fullType": "list"}, {"name": "all_predictions", "type": "list", "fullType": "list"}, {"name": "argparse", "type": "module", "fullType": "module"}, {"name": "average_predictions", "type": "function", "fullType": "function"}, {"name": "ax", "type": "Axes", "fullType": "matplotlib.axes._axes.Axes"}, {"name": "base_directory", "type": "str", "fullType": "str"}, {"name": "batch_size", "type": "int", "fullType": "int"}, {"name": "bbox_4326", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "box", "type": "function", "fullType": "function"}, {"name": "buil_create_full_image", "type": "function", "fullType": "function"}, {"name": "buil_strided_fullds", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "buildGeoDataset_GC", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_MN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_PN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_SD", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_TG", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "building_scene", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "buildings3857", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "buildings_sceneGC", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_sceneMN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_scenePN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_sceneSD", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_sceneTG", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_vector_source", "type": "CustomGeoJSONVectorSource", "fullType": "src.features.dataloaders.CustomGeoJSONVectorSource"}, {"name": "calculate_metrics", "type": "function", "fullType": "function"}, {"name": "check_nan_params", "type": "function", "fullType": "function"}, {"name": "checkpoint_callback", "type": "ModelCheckpoint", "fullType": "pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint"}, {"name": "chip", "type": "ndarray", "fullType": "numpy.ndarray"}, {"name": "cities", "type": "dict", "fullType": "dict"}, {"name": "city", "type": "str", "fullType": "str"}, {"name": "city_name", "type": "str", "fullType": "str"}, {"name": "class_config", "type": "ClassConfig", "fullType": "rastervision.core.data.class_config.ClassConfig"}, {"name": "clear_directory", "type": "function", "fullType": "function"}, {"name": "collate_multi_fn", "type": "function", "fullType": "function"}, {"name": "countries", "type": "list", "fullType": "list"}, {"name": "country", "type": "str", "fullType": "str"}, {"name": "country_directory", "type": "str", "fullType": "str"}, {"name": "create_predictions_and_ground_truth_plot", "type": "function", "fullType": "function"}, {"name": "create_scenes_for_city", "type": "function", "fullType": "function"}, {"name": "create_sentinel_mosaic", "type": "function", "fullType": "function"}, {"name": "create_sentinel_scene", "type": "function", "fullType": "function"}, {"name": "crs_transformer", "type": "RasterioCRSTransformer", "fullType": "rastervision.core.data.crs_transformer.rasterio_crs_transformer.RasterioCRSTransformer"}, {"name": "crs_transformer_buil", "type": "RasterioCRSTransformer", "fullType": "rastervision.core.data.crs_transformer.rasterio_crs_transformer.RasterioCRSTransformer"}, {"name": "crs_transformer_buildings", "type": "RasterioCRSTransformer", "fullType": "rastervision.core.data.crs_transformer.rasterio_crs_transformer.RasterioCRSTransformer"}, {"name": "current_dir", "type": "str", "fullType": "str"}, {"name": "cv", "type": "MultiInputCrossValidator", "fullType": "src.features.dataloaders.MultiInputCrossValidator"}, {"name": "data_module", "type": "MultiModalDataModule", "fullType": "src.models.model_definitions.MultiModalDataModule"}, {"name": "datetime", "type": "type", "fullType": "type"}, {"name": "deeplabv3_resnet50", "type": "function", "fullType": "function"}, {"name": "device", "type": "device", "fullType": "torch.device"}, {"name": "display_mosaic", "type": "function", "fullType": "function"}, {"name": "early_stopping_callback", "type": "EarlyStopping", "fullType": "pytorch_lightning.callbacks.early_stopping.EarlyStopping"}, {"name": "ee", "type": "module", "fullType": "module"}, {"name": "ensure_tuple", "type": "function", "fullType": "function"}, {"name": "extent_for_buildings", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "fig", "type": "Figure", "fullType": "matplotlib.figure.Figure"}, {"name": "file_path", "type": "str", "fullType": "str"}, {"name": "filename", "type": "str", "fullType": "str"}, {"name": "fixed_stats_transformer", "type": "FixedStatsTransformer", "fullType": "src.features.dataloaders.FixedStatsTransformer"}, {"name": "folium", "type": "module", "fullType": "module"}, {"name": "from_bounds", "type": "function", "fullType": "function"}, {"name": "gdf", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "gdfs", "type": "list", "fullType": "list"}, {"name": "geemap", "type": "module", "fullType": "module"}, {"name": "generate_and_display_predictions", "type": "function", "fullType": "function"}, {"name": "geometry_mask", "type": "function", "fullType": "function"}, {"name": "get_ipython", "type": "function", "fullType": "function"}, {"name": "get_label_source_from_merge_dataset", "type": "function", "fullType": "function"}, {"name": "get_model_complexity_info", "type": "function", "fullType": "function"}, {"name": "get_sentinel_items", "type": "function", "fullType": "function"}, {"name": "glob", "type": "module", "fullType": "module"}, {"name": "gpd", "type": "module", "fullType": "module"}, {"name": "grandparent_dir", "type": "str", "fullType": "str"}, {"name": "hyperparameters", "type": "dict", "fullType": "dict"}, {"name": "image_pattern", "type": "str", "fullType": "str"}, {"name": "image_uri", "type": "str", "fullType": "str"}, {"name": "img_full", "type": "ndarray", "fullType": "numpy.ndarray"}, {"name": "index", "type": "int", "fullType": "int"}, {"name": "labels", "type": "list", "fullType": "list"}, {"name": "load_config", "type": "function", "fullType": "function"}, {"name": "load_multimodal_model", "type": "function", "fullType": "function"}, {"name": "make_buildings_raster", "type": "function", "fullType": "function"}, {"name": "make_predictions", "type": "function", "fullType": "function"}, {"name": "make_sentinel_raster", "type": "function", "fullType": "function"}, {"name": "mask", "type": "function", "fullType": "function"}, {"name": "matching_files", "type": "list", "fullType": "list"}, {"name": "math", "type": "module", "fullType": "module"}, {"name": "merge_geojson_files", "type": "function", "fullType": "function"}, {"name": "mergedds", "type": "MergeDataset", "fullType": "src.features.dataloaders.MergeDataset"}, {"name": "model", "type": "MultiResolutionDeepLabV3", "fullType": "src.models.model_definitions.MultiResolutionDeepLabV3"}, {"name": "model_paths", "type": "list", "fullType": "list"}, {"name": "models", "type": "list", "fullType": "list"}, {"name": "multimodal_datasets", "type": "dict", "fullType": "dict"}, {"name": "nir_rgb_means", "type": "list", "fullType": "list"}, {"name": "nir_rgb_stds", "type": "list", "fullType": "list"}, {"name": "nn", "type": "module", "fullType": "module"}, {"name": "np", "type": "module", "fullType": "module"}, {"name": "os", "type": "module", "fullType": "module"}, {"name": "output_dir", "type": "str", "fullType": "str"}, {"name": "output_file", "type": "str", "fullType": "str"}, {"name": "parent_dir", "type": "str", "fullType": "str"}, {"name": "parse_args", "type": "function", "fullType": "function"}, {"name": "pd", "type": "module", "fullType": "module"}, {"name": "pl", "type": "module", "fullType": "module"}, {"name": "plt", "type": "module", "fullType": "module"}, {"name": "pred_label_store", "type": "SemanticSegmentationLabelStore", "fullType": "rastervision.core.data.label_store.semantic_segmentation_label_store.SemanticSegmentationLabelStore"}, {"name": "pred_labels", "type": "SemanticSegmentationSmoothLabels", "fullType": "rastervision.core.data.label.semantic_segmentation_labels.SemanticSegmentationSmoothLabels"}, {"name": "predictions", "type": "dict", "fullType": "dict"}, {"name": "predictions_folder_path", "type": "str", "fullType": "str"}, {"name": "process_city", "type": "function", "fullType": "function"}, {"name": "query_buildings_data", "type": "function", "fullType": "function"}, {"name": "rasterio", "type": "module", "fullType": "module"}, {"name": "rasterized_buildings_source", "type": "RasterizedSource", "fullType": "rastervision.core.data.raster_source.rasterized_source.RasterizedSource"}, {"name": "re", "type": "module", "fullType": "module"}, {"name": "result", "type": "dict", "fullType": "dict"}, {"name": "results", "type": "list", "fullType": "list"}, {"name": "results_df", "type": "DataFrame", "fullType": "pandas.core.frame.DataFrame"}, {"name": "row", "type": "Series", "fullType": "pandas.core.series.Series"}, {"name": "senitnel_create_full_image", "type": "function", "fullType": "function"}, {"name": "sent_strided_fullds", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "sentinelGeoDataset_GC", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_MN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_PN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_SD", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_TG", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "sentinel_bbox", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "sentinel_extent", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "sentinel_scene", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneGC", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneMN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_scenePN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneSD", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneTG", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_source_normalized", "type": "RasterioSource", "fullType": "rastervision.core.data.raster_source.rasterio_source.RasterioSource"}, {"name": "show_first_batch_item", "type": "function", "fullType": "function"}, {"name": "show_single_tile_multi", "type": "function", "fullType": "function"}, {"name": "show_windows", "type": "function", "fullType": "function"}, {"name": "sica_cities", "type": "str", "fullType": "str"}, {"name": "sica_countries", "type": "list", "fullType": "list"}, {"name": "split_index", "type": "int", "fullType": "int"}, {"name": "split_multipolygons", "type": "function", "fullType": "function"}, {"name": "sys", "type": "module", "fullType": "module"}, {"name": "torch", "type": "module", "fullType": "module"}, {"name": "tqdm", "type": "type", "fullType": "type"}, {"name": "train_cities", "type": "str", "fullType": "str"}, {"name": "train_dataset", "type": "ConcatDataset", "fullType": "torch.utils.data.dataset.ConcatDataset"}, {"name": "train_loader", "type": "DataLoader", "fullType": "torch.utils.data.dataloader.DataLoader"}, {"name": "trainer", "type": "Trainer", "fullType": "pytorch_lightning.trainer.trainer.Trainer"}, {"name": "transformer", "type": "Transformer", "fullType": "pyproj.transformer.Transformer"}, {"name": "unary_union", "type": "method", "fullType": "method"}, {"name": "urab_areas_folder_path", "type": "str", "fullType": "str"}, {"name": "urban_areas", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "val_city_indices", "type": "dict", "fullType": "dict"}, {"name": "val_dataset", "type": "ConcatDataset", "fullType": "torch.utils.data.dataset.ConcatDataset"}, {"name": "val_loader", "type": "DataLoader", "fullType": "torch.utils.data.dataloader.DataLoader"}, {"name": "vector_output_config", "type": "CustomVectorOutputConfig", "fullType": "src.models.model_definitions.CustomVectorOutputConfig"}, {"name": "visualization_callback", "type": "PredictionVisualizationCallback", "fullType": "__main__.PredictionVisualizationCallback"}, {"name": "wandb", "type": "module", "fullType": "module"}, {"name": "wandb_logger", "type": "WandbLogger", "fullType": "pytorch_lightning.loggers.wandb.WandbLogger"}, {"name": "windows", "type": "list", "fullType": "list"}, {"name": "xmax3857", "type": "float", "fullType": "float"}, {"name": "xmax_4326", "type": "float", "fullType": "float"}, {"name": "xmin3857", "type": "float", "fullType": "float"}, {"name": "xmin3857b", "type": "float64", "fullType": "numpy.float64"}, {"name": "xmin_4326", "type": "float", "fullType": "float"}, {"name": "yaml", "type": "module", "fullType": "module"}, {"name": "ymax3857", "type": "float", "fullType": "float"}, {"name": "ymax3857b", "type": "float64", "fullType": "numpy.float64"}, {"name": "ymax_4326", "type": "float", "fullType": "float"}, {"name": "ymin3857", "type": "float", "fullType": "float"}, {"name": "ymin_4326", "type": "float", "fullType": "float"}]
[{"name": "A", "type": "module", "fullType": "module"}, {"name": "Affine", "type": "type", "fullType": "type"}, {"name": "Any", "type": "_AnyMeta", "fullType": "typing._AnyMeta"}, {"name": "Box", "type": "type", "fullType": "type"}, {"name": "CRSTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Callback", "type": "type", "fullType": "type"}, {"name": "ClassConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "ClassInferenceTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Client", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "ConcatDataset", "type": "type", "fullType": "type"}, {"name": "CustomGeoJSONVectorSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "CustomRasterizedSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "CustomSlidingWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "CustomVectorOutputConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "DataLoader", "type": "type", "fullType": "type"}, {"name": "DeepLabHead", "type": "type", "fullType": "type"}, {"name": "Dict", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "EarlyStopping", "type": "type", "fullType": "type"}, {"name": "F", "type": "module", "fullType": "module"}, {"name": "FeatureMapVisualization", "type": "type", "fullType": "type"}, {"name": "FixedStatsTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "GeoJSONVectorSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "GeoJSONVectorSourceConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "IdentityCRSTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Iterator", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "LabelSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "LightningDataModule", "type": "type", "fullType": "type"}, {"name": "List", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "MergeDataset", "type": "type", "fullType": "type"}, {"name": "ModelCheckpoint", "type": "type", "fullType": "type"}, {"name": "MultiInputCrossValidator", "type": "type", "fullType": "type"}, {"name": "MultiModalDataModule", "type": "type", "fullType": "type"}, {"name": "MultiPolygon", "type": "type", "fullType": "type"}, {"name": "MultiResPredictionsIterator", "type": "type", "fullType": "type"}, {"name": "MultiResolutionDeepLabV3", "type": "type", "fullType": "type"}, {"name": "NonNegInt", "type": "ConstrainedNumberMeta", "fullType": "pydantic.types.ConstrainedNumberMeta"}, {"name": "Optional", "type": "_SpecialForm", "fullType": "typing._SpecialForm"}, {"name": "OrderedDict", "type": "type", "fullType": "type"}, {"name": "Polygon", "type": "type", "fullType": "type"}, {"name": "PolygonWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "PosInt", "type": "ConstrainedNumberMeta", "fullType": "pydantic.types.ConstrainedNumberMeta"}, {"name": "PredictionVisualizationCallback", "type": "type", "fullType": "type"}, {"name": "RasterSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterStats", "type": "type", "fullType": "type"}, {"name": "RasterTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterioCRSTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterioSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterizedSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "RasterizedSourceConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "Scene", "type": "type", "fullType": "type"}, {"name": "SemanticSegmentationDiscreteLabels", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationEvaluator", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationLabelStore", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationLabels", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "SemanticSegmentationSlidingWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "Sequence", "type": "_SpecialGenericAlias", "fullType": "typing._SpecialGenericAlias"}, {"name": "SlidingWindowGeoDataset", "type": "type", "fullType": "type"}, {"name": "StatsTransformer", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "Subset", "type": "type", "fullType": "type"}, {"name": "TF_TYPE_TO_TF_FUNC", "type": "dict", "fullType": "dict"}, {"name": "TYPE_CHECKING", "type": "bool", "fullType": "bool"}, {"name": "Trainer", "type": "type", "fullType": "type"}, {"name": "TransformType", "type": "EnumType", "fullType": "enum.EnumType"}, {"name": "Transformer", "type": "type", "fullType": "type"}, {"name": "Tuple", "type": "_TupleType", "fullType": "typing._TupleType"}, {"name": "Union", "type": "_SpecialForm", "fullType": "typing._SpecialForm"}, {"name": "VectorSource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "VectorSourceConfig", "type": "ModelMetaclass", "fullType": "pydantic.main.ModelMetaclass"}, {"name": "WandbLogger", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "XarraySource", "type": "ABCMeta", "fullType": "abc.ABCMeta"}, {"name": "affine_transform_buildings", "type": "Affine", "fullType": "affine.Affine"}, {"name": "aggregated_predictions", "type": "list", "fullType": "list"}, {"name": "all_predictions", "type": "list", "fullType": "list"}, {"name": "argparse", "type": "module", "fullType": "module"}, {"name": "average_predictions", "type": "function", "fullType": "function"}, {"name": "ax", "type": "Axes", "fullType": "matplotlib.axes._axes.Axes"}, {"name": "base_directory", "type": "str", "fullType": "str"}, {"name": "batch_size", "type": "int", "fullType": "int"}, {"name": "bbox_4326", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "box", "type": "function", "fullType": "function"}, {"name": "buil_create_full_image", "type": "function", "fullType": "function"}, {"name": "buil_strided_fullds", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "buildGeoDataset_GC", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_MN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_PN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_SD", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "buildGeoDataset_TG", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "building_scene", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "buildings3857", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "buildings_sceneGC", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_sceneMN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_scenePN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_sceneSD", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_sceneTG", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "buildings_vector_source", "type": "CustomGeoJSONVectorSource", "fullType": "src.features.dataloaders.CustomGeoJSONVectorSource"}, {"name": "calculate_metrics", "type": "function", "fullType": "function"}, {"name": "check_nan_params", "type": "function", "fullType": "function"}, {"name": "checkpoint_callback", "type": "ModelCheckpoint", "fullType": "pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint"}, {"name": "chip", "type": "ndarray", "fullType": "numpy.ndarray"}, {"name": "cities", "type": "dict", "fullType": "dict"}, {"name": "city", "type": "str", "fullType": "str"}, {"name": "city_name", "type": "str", "fullType": "str"}, {"name": "class_config", "type": "ClassConfig", "fullType": "rastervision.core.data.class_config.ClassConfig"}, {"name": "clear_directory", "type": "function", "fullType": "function"}, {"name": "collate_multi_fn", "type": "function", "fullType": "function"}, {"name": "countries", "type": "list", "fullType": "list"}, {"name": "country", "type": "str", "fullType": "str"}, {"name": "country_directory", "type": "str", "fullType": "str"}, {"name": "create_predictions_and_ground_truth_plot", "type": "function", "fullType": "function"}, {"name": "create_scenes_for_city", "type": "function", "fullType": "function"}, {"name": "create_sentinel_mosaic", "type": "function", "fullType": "function"}, {"name": "create_sentinel_scene", "type": "function", "fullType": "function"}, {"name": "crs_transformer", "type": "RasterioCRSTransformer", "fullType": "rastervision.core.data.crs_transformer.rasterio_crs_transformer.RasterioCRSTransformer"}, {"name": "crs_transformer_buil", "type": "RasterioCRSTransformer", "fullType": "rastervision.core.data.crs_transformer.rasterio_crs_transformer.RasterioCRSTransformer"}, {"name": "crs_transformer_buildings", "type": "RasterioCRSTransformer", "fullType": "rastervision.core.data.crs_transformer.rasterio_crs_transformer.RasterioCRSTransformer"}, {"name": "current_dir", "type": "str", "fullType": "str"}, {"name": "cv", "type": "MultiInputCrossValidator", "fullType": "src.features.dataloaders.MultiInputCrossValidator"}, {"name": "data_module", "type": "MultiModalDataModule", "fullType": "src.models.model_definitions.MultiModalDataModule"}, {"name": "datetime", "type": "type", "fullType": "type"}, {"name": "deeplabv3_resnet50", "type": "function", "fullType": "function"}, {"name": "device", "type": "device", "fullType": "torch.device"}, {"name": "display_mosaic", "type": "function", "fullType": "function"}, {"name": "early_stopping_callback", "type": "EarlyStopping", "fullType": "pytorch_lightning.callbacks.early_stopping.EarlyStopping"}, {"name": "ee", "type": "module", "fullType": "module"}, {"name": "ensure_tuple", "type": "function", "fullType": "function"}, {"name": "extent_for_buildings", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "fig", "type": "Figure", "fullType": "matplotlib.figure.Figure"}, {"name": "file_path", "type": "str", "fullType": "str"}, {"name": "filename", "type": "str", "fullType": "str"}, {"name": "fixed_stats_transformer", "type": "FixedStatsTransformer", "fullType": "src.features.dataloaders.FixedStatsTransformer"}, {"name": "folium", "type": "module", "fullType": "module"}, {"name": "from_bounds", "type": "function", "fullType": "function"}, {"name": "gdf", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "gdfs", "type": "list", "fullType": "list"}, {"name": "geemap", "type": "module", "fullType": "module"}, {"name": "generate_and_display_predictions", "type": "function", "fullType": "function"}, {"name": "geometry_mask", "type": "function", "fullType": "function"}, {"name": "get_ipython", "type": "function", "fullType": "function"}, {"name": "get_label_source_from_merge_dataset", "type": "function", "fullType": "function"}, {"name": "get_model_complexity_info", "type": "function", "fullType": "function"}, {"name": "get_sentinel_items", "type": "function", "fullType": "function"}, {"name": "glob", "type": "module", "fullType": "module"}, {"name": "gpd", "type": "module", "fullType": "module"}, {"name": "grandparent_dir", "type": "str", "fullType": "str"}, {"name": "hyperparameters", "type": "dict", "fullType": "dict"}, {"name": "image_pattern", "type": "str", "fullType": "str"}, {"name": "image_uri", "type": "str", "fullType": "str"}, {"name": "img_full", "type": "ndarray", "fullType": "numpy.ndarray"}, {"name": "index", "type": "int", "fullType": "int"}, {"name": "labels", "type": "list", "fullType": "list"}, {"name": "load_config", "type": "function", "fullType": "function"}, {"name": "load_multimodal_model", "type": "function", "fullType": "function"}, {"name": "make_buildings_raster", "type": "function", "fullType": "function"}, {"name": "make_predictions", "type": "function", "fullType": "function"}, {"name": "make_sentinel_raster", "type": "function", "fullType": "function"}, {"name": "mask", "type": "function", "fullType": "function"}, {"name": "matching_files", "type": "list", "fullType": "list"}, {"name": "math", "type": "module", "fullType": "module"}, {"name": "merge_geojson_files", "type": "function", "fullType": "function"}, {"name": "mergedds", "type": "MergeDataset", "fullType": "src.features.dataloaders.MergeDataset"}, {"name": "model", "type": "MultiResolutionDeepLabV3", "fullType": "src.models.model_definitions.MultiResolutionDeepLabV3"}, {"name": "model_paths", "type": "list", "fullType": "list"}, {"name": "models", "type": "list", "fullType": "list"}, {"name": "multimodal_datasets", "type": "dict", "fullType": "dict"}, {"name": "nir_rgb_means", "type": "list", "fullType": "list"}, {"name": "nir_rgb_stds", "type": "list", "fullType": "list"}, {"name": "nn", "type": "module", "fullType": "module"}, {"name": "np", "type": "module", "fullType": "module"}, {"name": "os", "type": "module", "fullType": "module"}, {"name": "output_dir", "type": "str", "fullType": "str"}, {"name": "output_file", "type": "str", "fullType": "str"}, {"name": "parent_dir", "type": "str", "fullType": "str"}, {"name": "parse_args", "type": "function", "fullType": "function"}, {"name": "pd", "type": "module", "fullType": "module"}, {"name": "pl", "type": "module", "fullType": "module"}, {"name": "plt", "type": "module", "fullType": "module"}, {"name": "pred_label_store", "type": "SemanticSegmentationLabelStore", "fullType": "rastervision.core.data.label_store.semantic_segmentation_label_store.SemanticSegmentationLabelStore"}, {"name": "pred_labels", "type": "SemanticSegmentationSmoothLabels", "fullType": "rastervision.core.data.label.semantic_segmentation_labels.SemanticSegmentationSmoothLabels"}, {"name": "predictions", "type": "dict", "fullType": "dict"}, {"name": "predictions_folder_path", "type": "str", "fullType": "str"}, {"name": "process_city", "type": "function", "fullType": "function"}, {"name": "query_buildings_data", "type": "function", "fullType": "function"}, {"name": "rasterio", "type": "module", "fullType": "module"}, {"name": "rasterized_buildings_source", "type": "RasterizedSource", "fullType": "rastervision.core.data.raster_source.rasterized_source.RasterizedSource"}, {"name": "re", "type": "module", "fullType": "module"}, {"name": "result", "type": "dict", "fullType": "dict"}, {"name": "results", "type": "list", "fullType": "list"}, {"name": "results_df", "type": "DataFrame", "fullType": "pandas.core.frame.DataFrame"}, {"name": "row", "type": "Series", "fullType": "pandas.core.series.Series"}, {"name": "senitnel_create_full_image", "type": "function", "fullType": "function"}, {"name": "sent_strided_fullds", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "sentinelGeoDataset_GC", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_MN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_PN", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_SD", "type": "PolygonWindowGeoDataset", "fullType": "src.features.dataloaders.PolygonWindowGeoDataset"}, {"name": "sentinelGeoDataset_TG", "type": "CustomSlidingWindowGeoDataset", "fullType": "src.features.dataloaders.CustomSlidingWindowGeoDataset"}, {"name": "sentinel_bbox", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "sentinel_extent", "type": "Box", "fullType": "rastervision.core.box.Box"}, {"name": "sentinel_scene", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneGC", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneMN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_scenePN", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneSD", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_sceneTG", "type": "Scene", "fullType": "rastervision.core.data.scene.Scene"}, {"name": "sentinel_source_normalized", "type": "RasterioSource", "fullType": "rastervision.core.data.raster_source.rasterio_source.RasterioSource"}, {"name": "show_first_batch_item", "type": "function", "fullType": "function"}, {"name": "show_single_tile_multi", "type": "function", "fullType": "function"}, {"name": "show_windows", "type": "function", "fullType": "function"}, {"name": "sica_cities", "type": "str", "fullType": "str"}, {"name": "sica_countries", "type": "list", "fullType": "list"}, {"name": "split_index", "type": "int", "fullType": "int"}, {"name": "split_multipolygons", "type": "function", "fullType": "function"}, {"name": "sys", "type": "module", "fullType": "module"}, {"name": "torch", "type": "module", "fullType": "module"}, {"name": "tqdm", "type": "type", "fullType": "type"}, {"name": "train_cities", "type": "str", "fullType": "str"}, {"name": "train_dataset", "type": "ConcatDataset", "fullType": "torch.utils.data.dataset.ConcatDataset"}, {"name": "train_loader", "type": "DataLoader", "fullType": "torch.utils.data.dataloader.DataLoader"}, {"name": "trainer", "type": "Trainer", "fullType": "pytorch_lightning.trainer.trainer.Trainer"}, {"name": "transformer", "type": "Transformer", "fullType": "pyproj.transformer.Transformer"}, {"name": "unary_union", "type": "method", "fullType": "method"}, {"name": "urab_areas_folder_path", "type": "str", "fullType": "str"}, {"name": "urban_areas", "type": "GeoDataFrame", "fullType": "geopandas.geodataframe.GeoDataFrame"}, {"name": "val_city_indices", "type": "dict", "fullType": "dict"}, {"name": "val_dataset", "type": "ConcatDataset", "fullType": "torch.utils.data.dataset.ConcatDataset"}, {"name": "val_loader", "type": "DataLoader", "fullType": "torch.utils.data.dataloader.DataLoader"}, {"name": "vector_output_config", "type": "CustomVectorOutputConfig", "fullType": "src.models.model_definitions.CustomVectorOutputConfig"}, {"name": "visualization_callback", "type": "PredictionVisualizationCallback", "fullType": "__main__.PredictionVisualizationCallback"}, {"name": "wandb", "type": "module", "fullType": "module"}, {"name": "wandb_logger", "type": "WandbLogger", "fullType": "pytorch_lightning.loggers.wandb.WandbLogger"}, {"name": "windows", "type": "list", "fullType": "list"}, {"name": "xmax3857", "type": "float", "fullType": "float"}, {"name": "xmax_4326", "type": "float", "fullType": "float"}, {"name": "xmin3857", "type": "float", "fullType": "float"}, {"name": "xmin3857b", "type": "float64", "fullType": "numpy.float64"}, {"name": "xmin_4326", "type": "float", "fullType": "float"}, {"name": "yaml", "type": "module", "fullType": "module"}, {"name": "ymax3857", "type": "float", "fullType": "float"}, {"name": "ymax3857b", "type": "float64", "fullType": "numpy.float64"}, {"name": "ymax_4326", "type": "float", "fullType": "float"}, {"name": "ymin3857", "type": "float", "fullType": "float"}, {"name": "ymin_4326", "type": "float", "fullType": "float"}]
F1 on city full DS:0.13784542816800882
Metrics for split 1:
Metrics for SantoDomingo:
F1 Score: 0.0097
Precision: 0.9048
Recall: 0.0049
Metrics for GuatemalaCity:
F1 Score: 0.0089
Precision: 0.2647
Recall: 0.0045
Metrics for Tegucigalpa:
No correct predictions made. Metrics are NaN.
Metrics for Managua:
No correct predictions made. Metrics are NaN.
Metrics for Panama:
F1 Score: 0.0588
Precision: 0.3956
Recall: 0.0318
Average metrics across cities:
F1 Score: 0.0258
Precision: 0.5217
Recall: 0.0137
(Note: Tegucigalpa, Managua were excluded due to NaN metrics)
Train dataset size: 59
